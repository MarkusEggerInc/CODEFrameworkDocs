<div class="wikidoc">
<p><span style="color:#808080"><em>Excerpt from an internal email at EPS/CODE:</em></span></p>
<h2>Binding Events to Commands in WPF</h2>
<p>CODE Framework (probably released tomorrow or the day after)&nbsp;has the ability to hook any event on any object using a command. In other words: Rather than writing an event handler, you can now bind an event to a command like so:</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">&lt;</span><span style="color:#a31515">Window</span> <span style="color:red">x:Class</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CODE.Framework.Wpf.TestBench.EventCommandTest</span><span style="color:black">&quot;</span>
        <span style="color:red">xmlns</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span><span style="color:black">&quot;</span>
        <span style="color:red">xmlns:x</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">http://schemas.microsoft.com/winfx/2006/xaml</span><span style="color:black">&quot;</span>
        <span style="color:red">xmlns:c</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">clr-namespace:CODE.Framework.Wpf.Controls;assembly=CODE.Framework.Wpf</span><span style="color:black">&quot;</span> 
        <span style="color:red">Title</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">EventCommandTest</span><span style="color:black">&quot;</span> <span style="color:red">Height</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">300</span><span style="color:black">&quot;</span> <span style="color:red">Width</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">300</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">Grid</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;</span><span style="color:#a31515">Button</span> <span style="color:red">Content</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Hello</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">Ex.EventCommand</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommand</span> <span style="color:red">Command</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding DoubleClickCommand}</span><span style="color:black">&quot;</span> <span style="color:red">Event</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MouseDoubleClick</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
            <span style="color:blue">&lt;/</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">Ex.EventCommand</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;/</span><span style="color:#a31515">Button</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">Grid</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">Window</span><span style="color:blue">&gt;</span>
</pre>
</div>
<p>So you simply set the EventCommand property defined on the generic &ldquo;Ex&rdquo; object (which we will use for similar things in the future&hellip; &ldquo;Ex&rdquo; stands for &ldquo;generic
<span style="color:red">Ex</span>tensions&rdquo;). You then specify a command, the event you want to use as a string, and (optionally) a command parameter.&nbsp;</p>
<p>Typically, you will use this to bind one of our ViewActions to any event you want. (However, this works not just with ViewActions, but with all WPF commands).</p>
<p>Note that the above version only allows hooking a single event that way. If you want to hook more than one vent, you need to use the following, slightly more verbose syntax:&nbsp;</p>
<pre><span style="color:blue">&lt;</span><span style="color:#a31515">Window</span><span style="color:red">&nbsp;x</span><span style="color:blue">:</span><span style="color:red">Class</span><span style="color:blue">=&quot;CODE.Framework.Wpf.TestBench.EventCommandTest&quot;<br></span><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:red">&nbsp;xmlns</span><span style="color:blue">=&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot;<br></span><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:red">&nbsp;xmlns</span><span style="color:blue">:</span><span style="color:red">x</span><span style="color:blue">=&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a>&quot;<br></span><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:red">&nbsp;xmlns</span><span style="color:blue">:</span><span style="color:red">c</span><span style="color:blue">=&quot;clr-namespace:CODE.Framework.Wpf.Controls;assembly=CODE.Framework.Wpf&quot;</span><span style="color:black">&nbsp;<br></span><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:red">&nbsp;Title</span><span style="color:blue">=&quot;EventCommandTest&quot;</span><span style="color:red">&nbsp;Height</span><span style="color:blue">=&quot;300&quot;</span><span style="color:red">&nbsp;Width</span><span style="color:blue">=&quot;300&quot;&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;</span><span style="color:#a31515">Grid</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;</span><span style="color:#a31515">Button</span><span style="color:red">&nbsp;Content</span><span style="color:blue">=&quot;{</span><span style="color:#a31515">Binding</span><span style="color:red">&nbsp;TestCaption</span><span style="color:blue">}&quot;&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">Ex.EventCommands</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommandsCollection</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommand</span><span style="color:red">&nbsp;Command</span><span style="color:blue">=&quot;{</span><span style="color:#a31515">Binding</span><span style="color:red">&nbsp;TestCommand2</span><span style="color:blue">}&quot;</span><span style="color:red">&nbsp;Event</span><span style="color:blue">=&quot;MouseEnter&quot;&nbsp;/&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommand</span><span style="color:red">&nbsp;Command</span><span style="color:blue">=&quot;{</span><span style="color:#a31515">Binding</span><span style="color:red">&nbsp;TestCommand3</span><span style="color:blue">}&quot;</span><span style="color:red">&nbsp;Event</span><span style="color:blue">=&quot;MouseDoubleClick&quot;&nbsp;/&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;/</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommandsCollection</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;/</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">Ex.EventCommands</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;/</span><span style="color:#a31515">Button</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue">&lt;/</span><span style="color:#a31515">Grid</span><span style="color:blue">&gt;<br></span><span style="color:blue">&lt;/</span><span style="color:#a31515">Window</span><span style="color:blue">&gt;</span></pre>
<p>&nbsp;In this example, you set the EventCommands property (with an S at the end!) and unlike in the first version, you set this to a collection first, and then populate the collection of commands. You can bind to any number of events, and you could even
 bind more than one command to an event like this:</p>
<pre><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">Ex.EventCommands</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp; </span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommandsCollection</span><span style="color:blue">&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp; </span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommand</span><span style="color:red">&nbsp;Command</span><span style="color:blue">=&quot;{</span><span style="color:#a31515">Binding</span><span style="color:red">&nbsp;TestCommand2</span><span style="color:blue">}&quot;</span><span style="color:red">&nbsp;Event</span><span style="color:blue">=&quot;MouseEnter&quot;&nbsp;/&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp; </span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommand</span><span style="color:red">&nbsp;Command</span><span style="color:blue">=&quot;{</span><span style="color:#a31515">Binding</span><span style="color:red">&nbsp;TestCommand3</span><span style="color:blue">}&quot;</span><span style="color:red">&nbsp;Event</span><span style="color:blue">=&quot;MouseDoubleClick&quot;&nbsp;/&gt;<br></span><span style="color:#a31515">&nbsp;&nbsp;&nbsp; </span><span style="color:blue">&lt;</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommand</span><span style="color:red">&nbsp;Command</span><span style="color:blue">=&quot;{</span><span style="color:#a31515">Binding</span><span style="color:red">&nbsp;TestCommand3b</span><span style="color:blue">}&quot;</span><span style="color:red">&nbsp;Event</span><span style="color:blue">=&quot;MouseDoubleClick&quot;&nbsp;/&gt;<br></span><span style="color:#a31515">&nbsp; </span><span style="color:blue">&lt;/</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">EventCommandsCollection</span><span style="color:blue">&gt;<br></span><span style="color:blue">&lt;/</span><span style="color:#a31515">c</span><span style="color:blue">:</span><span style="color:#a31515">Ex.EventCommands</span><span style="color:blue">&gt;</span></pre>
<p>So this should be quite useful, as it eliminates the vast majority of scenarios that require code-behind files, or behaviors. It is of course still better to use explicit commands if the exist. There is no reason to use this for the click event of a button
 for instance, since a button has a native Command property that fires when the click event happens. Similarly, we have special commands when a selection on a listbox happens. And we will add more such commands in the future. In those cases, do NOT use the
 construct described here, but use the native way to raise commands.</p>
<p>&nbsp;</p>
</div><div class="ClearBoth"></div>