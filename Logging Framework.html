<div class="wikidoc">
<p>Logging is the process of notifying an entity of a certain event, typically (but not always) with the event being stored away to preserve a record of it. CODE Framework provides an extensive logging framework that provides a central logging mediator, which
 in turn passes logged events on to all kinds of registered individual logger objects, which can handle the provided events as they see fit. CODE Framework provides a number of loggers out of the box (such as logging to file, Windows event log, email, the console,...).
 It is also possible to create custom loggers easily.</p>
<h2>Publishing an Event to be Logged</h2>
<p>The simplest way of logging an event is to call the logging mediator's log method with a simple string parameter.</p>
<div style="color:black">
<pre>CODE.Framework.Core.Utilities.LoggingMediator.Log(<span style="color:#a31515">&quot;Application started.&quot;</span>); 
</pre>
</div>
<p>This passes the string on to all registered loggers (see below).</p>
<p><em>Note: It is recommended to use a using statement in your code so you do not always have to type out the complete namespace name.</em></p>
<p>It is also possible to provide more detailed information, in particular the type of event:</p>
<div style="color:black">
<pre>LoggingMediator.Log(<span style="color:#a31515">&quot;Application started.&quot;</span>,LogEventType.Information); 
</pre>
</div>
<p>There are various types of events identified by the <em>LogEventType</em> enumeration. This enumeration is a bit-flag enumeration, so all the different types can be combined as in this example:</p>
<div style="color:black">
<pre>LoggingMediator.Log(<span style="color:#a31515">&quot;Something happened.&quot;</span>, LogEventType.Exception | LogEventType.Critical); 
</pre>
</div>
<p>In addition to logging strings, it is possible to log entire objects:</p>
<div style="color:black">
<pre>LoggingMediator.Log(customer, LogEventType.Information);
</pre>
</div>
<p>In this case, it is up to the registered loggers to make use of the object as they see fit. Many of the default loggers however simply perform an [object]<em>.ToString()</em>.</p>
<p>Another overload of the logging mediator makes it possible to log exception information easily:</p>
<div style="color:black">
<pre><span style="color:blue">try</span>
{
}
<span style="color:blue">catch</span> (Exception ex)
{
    LoggingMediator.Log(ex, LogEventType.Exception);
} 
</pre>
</div>
<p>In this case, the logging mediator uses the ExceptionHelper class to retrieve a detailed text description of the exception, which is then logged as text.</p>
<p>A related overload allows logging manual text in combination with exception information:</p>
<div style="color:black">
<div style="color:black">
<pre>LoggingMediator.Log(<span style="color:#a31515">&quot;An error has occurred!&quot;</span>, ex, LogEventType.Exception);
</pre>
</div>
</div>
<p>The additional string parameter is combined with the exception text for logging.</p>
<h2>Logger Objects</h2>
<p>By default, the logging mediator doesn't perform any action other than passing events on to registered loggers, of which there aren't any unless they are registered with the logger. Here is a simple example of registering a logger with the logging mediator:</p>
<div style="color:black">
<pre>LoggingMediator.ClearLoggers();
LoggingMediator.AddLogger(<span style="color:blue">new</span> ConsoleLogger());
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>Once a logger is registered, it will generally receive all logged events.</p>
<p>Note that it is possible to register any number of loggers:</p>
<div style="color:black">
<pre>LoggingMediator.ClearLoggers();
LoggingMediator.AddLogger(<span style="color:blue">new</span> ConsoleLogger());
LoggingMediator.AddLogger(<span style="color:blue">new</span> MessageBoxLogger());
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>Loggers always receive events in the order the loggers were registered. In this example, the console logger is triggered before the message box logger.</p>
<h3>Event Filtering</h3>
<p>If the logger is to be used for certain events only, then one can set a type filter:</p>
<div style="color:black">
<pre>LoggingMediator.ClearLoggers();
ConsoleLogger logger = <span style="color:blue">new</span> ConsoleLogger();
logger.TypeFilter = LogEventType.Exception;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); <span style="color:green">// Not logged (considered type 'Information')</span>
LoggingMediator.Log(<span style="color:#a31515">&quot;Test 2&quot;</span>, LogEventType.Exception); <span style="color:green">// Logged </span>
</pre>
</div>
<p>Filters are also bit-flags and can thus be combined:</p>
<div style="color:black">
<pre>LoggingMediator.ClearLoggers();
ConsoleLogger logger = <span style="color:blue">new</span> ConsoleLogger();
logger.TypeFilter = LogEventType.Exception | LogEventType.Error;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); <span style="color:green">// Not logged (considered type 'Information')</span>
LoggingMediator.Log(<span style="color:#a31515">&quot;Test 2&quot;</span>, LogEventType.Exception); <span style="color:green">// Logged</span>
LoggingMediator.Log(<span style="color:#a31515">&quot;Test 3&quot;</span>, LogEventType.Error); <span style="color:green">// Logged</span>
LoggingMediator.Log(<span style="color:#a31515">&quot;Test 4&quot;</span>, LogEventType.Exception | LogEventType.Error); <span style="color:green">// Logged</span>
LoggingMediator.Log(<span style="color:#a31515">&quot;Test 5&quot;</span>, LogEventType.Critical | LogEventType.Error); <span style="color:green">// Logged</span>
LoggingMediator.Log(<span style="color:#a31515">&quot;Test 6&quot;</span>, LogEventType.Critical | LogEventType.Information); <span style="color:green">// Not logged </span>
</pre>
</div>
<p>Note that the type filter can be set for each individual logger, so it is possible to have different loggers configured that react to different events.</p>
<h3>Clearing Loggers</h3>
<p>It is possible to re-configure loggers during runtime. For this purpose it is often convenient to clear the list of all previously registered loggers, which can be done like so:</p>
<div style="color:black">
<pre>LoggingMediator.ClearLoggers(); 
</pre>
</div>
<h2>Provided Standard Loggers</h2>
<p>CODE Framework ships with a number of standard logger objects that cover a wide range of logging needs.</p>
<h3>The Console Logger</h3>
<p>The console logger object logs events to the console. It is very similar in concept to issuing a
<em>Console.WriteLine()</em> call. Console loggers are set up like so:</p>
<div style="color:black">
<pre>LoggingMediator.AddLogger(<span style="color:blue">new</span> ConsoleLogger());
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<h3>Multi File Logger</h3>
<p>Multi file loggers log events to multiple files (each event gets its own log file). This logger must be configured with a path the log files are to be written to. This can be done by specifying the path as a string, or by providing a special folder:</p>
<div style="color:black">
<pre>LoggingMediator.AddLogger(<span style="color:blue">new</span> MultiFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>));
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>);
LoggingMediator.AddLogger(<span style="color:blue">new</span> MultiFileLogger(SpecialFolder.ApplicationData));
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>It is possible to omit the folder information. In that case, <em>SpecialFolder.ApplicationData</em> is the default.</p>
<p>By default, all log files have a &quot;.log&quot; extension. This can be changed:</p>
<div style="color:black">
<div style="color:black">
<pre><span style="color:blue">var</span> logger = <span style="color:blue">new</span> MultiFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>);
logger.Extension = <span style="color:#a31515">&quot;txt&quot;</span>;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
</div>
<p>The name for each file is a Guid converted to a string. To change the way file names are created, you must subclass the logger and override the
<em>GetNextFileName()</em> method:</p>
<div style="color:black">
<div style="color:black">
<pre><span style="color:blue">public</span> <span style="color:blue">class</span> MyMultiFileLogger : MultiFileLogger
{
    <span style="color:blue">public</span> MyMultiFileLogger(<span style="color:blue">string</span> path) : <span style="color:blue">base</span>(path) { }
    <span style="color:blue">public</span> <span style="color:blue">override</span> <span style="color:blue">string</span> GetNextFileName()
    {
        <span style="color:blue">return</span> System.Environment.TickCount.ToString() &#43; <span style="color:#a31515">&quot;.&quot;</span> &#43; <span style="color:blue">this</span>.Extension;
    }
}

<span style="color:blue">var</span> logger = <span style="color:blue">new</span> MyMultiFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>);
logger.Extension = <span style="color:#a31515">&quot;txt&quot;</span>;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>);
</pre>
</div>
</div>
<p>Note that this method must return the complete file name including the extension. Note also that it is important to create unique file names to avoid overwriting existing log files.</p>
<h3>Multi XML File Logger</h3>
<p>The multi-file XML logger object is similar in concept to the regular multi-file logger. However, it stores logged information in XML files, with an XML structure. Consider this example:</p>
<div style="color:black">
<pre>LoggingMediator.AddLogger(<span style="color:blue">new</span> MultiXmlFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>));
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>The resulting XML file has the following structure:</p>
<div style="color:black">
<pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span> <span style="color:red">encoding</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">utf-8</span><span style="color:black">&quot;</span> <span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">event</span> <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Information</span><span style="color:black">&quot;</span> <span style="color:red">timeStamp</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:02pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Test<span style="color:blue">&lt;/</span><span style="color:#a31515">event</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span> 
</pre>
</div>
<p>Note that the element and attribute names can be modified:</p>
<div style="color:black">
<pre><span style="color:blue">var</span> logger = <span style="color:blue">new</span> MultiXmlFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>)
logger.XmlRootNode = <span style="color:#a31515">&quot;root&quot;</span>;
logger.XmlEventNode = <span style="color:#a31515">&quot;record&quot;</span>;
logger.XmlEventTypeAttribute = <span style="color:#a31515">&quot;significance&quot;</span>;
logger.XmlEventTimeStampAttribute = <span style="color:#a31515">&quot;time&quot;</span>;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>This produces the following result</p>
<div style="color:black">
<pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span> <span style="color:red">encoding</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">utf-8</span><span style="color:black">&quot;</span> <span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">root</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">record</span> <span style="color:red">significance</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Information</span><span style="color:black">&quot;</span> <span style="color:red">time</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:02pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Test<span style="color:blue">&lt;/</span><span style="color:#a31515">record</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">root</span><span style="color:blue">&gt;</span> 
</pre>
</div>
<p>Note that it is also possible to pass actual XML to the logger as the text string. Whenever well-formed XML is passed to the logger, the XML structure will not be changed and instead, the provided XML will be serialized to disk as is:</p>
<div style="color:black">
<pre>LoggingMediator.Log(<span style="color:#a31515">&quot;Hello World!&quot;</span>); 
</pre>
</div>
<p>Result:</p>
<div style="color:black">
<pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span> <span style="color:red">encoding</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">utf-8</span><span style="color:black">&quot;</span> <span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span>Hello World!<span style="color:blue">&lt;/</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span> 
</pre>
</div>
<p>The XML multi-file logger object is a subclass of the regular multi-file logger class. Therefore, overriding file extension or creating a new file name algorithm are identical (see above).</p>
<p><em>Note: The actual value logged is properly encoded to make sure the XML file can accommodate all data passed to the logger.</em></p>
<h3>Single File Logger</h3>
<p>The single file logger object logs all events into a single text file. It requires a file name and a path when instantiated:</p>
<div style="color:black">
<pre>LoggingMediator.AddLogger(<span style="color:blue">new</span> SingleFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>, <span style="color:#a31515">&quot;MyLogFile.log&quot;</span>));
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>There also is a constructor overload without a file name. In that case, the default file name is &quot;Log.log&quot;. It is even possible to not provide a folder name. In that case,
<em>SpecialFolder.ApplicationData</em> is used (whatever that translates to on each machine).</p>
<p>All events are logged by adding them to the bottom of the file. The file grows unrestricted and can thus get very large.</p>
<h3>Single XML File Logger</h3>
<p>The single XML file logger is very similar to the regular single file logger, except that all information is logged into a single, structured XML file. Just like the regular single file logger, the XML single file logger can be configured with a folder and
 file name. Both are optional. The default file name is Log.xml. The default folder is
<em>SpecialFolder.ApplicationData</em> :</p>
<div style="color:black">
<pre>LoggingMediator.AddLogger(<span style="color:blue">new</span> SingleXmlFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>, <span style="color:#a31515">&quot;MyLog.xml&quot;</span>));
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>);
LoggingMediator.Log(<span style="color:#a31515">&quot;Some Exception&quot;</span>, LogEventType.Exception | LogEventType.Critical); 
</pre>
</div>
<p>This creates the following result:</p>
<div style="color:black">
<pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span> <span style="color:red">encoding</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">utf-8</span><span style="color:black">&quot;</span> <span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">event</span> <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Information</span><span style="color:black">&quot;</span> <span style="color:red">timeStamp</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:02pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Test<span style="color:blue">&lt;/</span><span style="color:#a31515">event</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">event</span> <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Exception, Critical</span><span style="color:black">&quot;</span> <span style="color:red">timeStamp</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:03pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Some Exception<span style="color:blue">&lt;/</span><span style="color:#a31515">event</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span> 
</pre>
</div>
<p>New events are always added at the bottom of the list. By default, the file grows unrestricted. However, it is possible to limit the list to a maximum number of entries. In that case, the oldest entries will be removed from the list:</p>
<div style="color:black">
<pre><span style="color:blue">var</span> logger= <span style="color:blue">new</span> SingleXmlFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>, <span style="color:#a31515">&quot;MyLog.xml&quot;</span>)
logger.MaximumEntries = 100;
LoggingMediator.AddLogger(logger); 
</pre>
</div>
<p>If <em>MaximumEntries</em> is set to -1, the list can grow unrestricted.</p>
<p>Just like with the XML multi-file logger, it is possible to change the names of the elements and attributes used by the logger:</p>
<div style="color:black">
<pre><span style="color:blue">var</span> logger = <span style="color:blue">new</span> MultiXmlFileLogger(<span style="color:#a31515">@&quot;c:\logs\&quot;</span>)
logger.XmlRootNode = <span style="color:#a31515">&quot;root&quot;</span>;
logger.XmlEventNode = <span style="color:#a31515">&quot;record&quot;</span>;
logger.XmlEventTypeAttribute = <span style="color:#a31515">&quot;significance&quot;</span>;
logger.XmlEventTimeStampAttribute = <span style="color:#a31515">&quot;time&quot;</span>;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>);
LoggingMediator.Log(<span style="color:#a31515">&quot;Some Exception&quot;</span>, LogEventType.Exception | LogEventType.Critical); 
</pre>
</div>
<p>The result is as follows:</p>
<div style="color:black">
<pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span> <span style="color:red">encoding</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">utf-8</span><span style="color:black">&quot;</span> <span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">root</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">record</span> <span style="color:red">significance</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Information</span><span style="color:black">&quot;</span> <span style="color:red">time</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:02pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Test<span style="color:blue">&lt;/</span><span style="color:#a31515">record</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">record</span> <span style="color:red">significance</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Exception, Critical</span><span style="color:black">&quot;</span> <span style="color:red">time</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:03pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Some Exception<span style="color:blue">&lt;/</span><span style="color:#a31515">record</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">root</span><span style="color:blue">&gt;</span> 
</pre>
</div>
<p>Note that if the file already exists, the root node name needs to match the name configured in the logger, otherwise the XML file will be overwritten, since CODE Framework considers the file structurally incompatible. However, it is possible to have child
 nodes of different names. The following is a valid XML log file (for the default logger configuration):</p>
<div style="color:black">
<pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span> <span style="color:red">encoding</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">utf-8</span><span style="color:black">&quot;</span> <span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">event</span> <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Information</span><span style="color:black">&quot;</span> <span style="color:red">timeStamp</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:02pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Test<span style="color:blue">&lt;/</span><span style="color:#a31515">event</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">test</span><span style="color:blue">&gt;</span>Some other node<span style="color:blue">&lt;/</span><span style="color:#a31515">test</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">event</span> <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Exception, Critical</span><span style="color:black">&quot;</span> <span style="color:red">timeStamp</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2/4/2008 3:03pm</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>Some Exception<span style="color:blue">&lt;/</span><span style="color:#a31515">event</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">log</span><span style="color:blue">&gt;</span> 
</pre>
</div>
<p>In this example, the test node is simply ignored.</p>
<p><em>Note: The actual value logged is properly encoded to make sure the XML file can accommodate all data passed to the logger.</em></p>
<h3>Event Log Logger</h3>
<p>This logger logs event information to the Windows Event Log. The log can reside on the local machine or on a remote machine.</p>
<p>This logger is set up like this:</p>
<div style="color:black">
<pre><span style="color:blue">var</span> logger = <span style="color:blue">new</span> EventLogger(<span style="color:#a31515">&quot;Log Name&quot;</span>)
logger.Source = <span style="color:#a31515">&quot;Application Name&quot;</span>;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>This creates a logger that logs to the windows event log. The name of the log in this example is &quot;Log Name&quot;. If such a log does not exist on the local machine, it will be created.</p>
<p>It is also possible to log to a remote machine:</p>
<div style="color:black">
<pre><span style="color:blue">var</span> logger = <span style="color:blue">new</span> EventLogger(<span style="color:#a31515">&quot;Log Name&quot;</span>, <span style="color:#a31515">&quot;ComputerName&quot;</span>)
logger.Source = <span style="color:#a31515">&quot;Application Name&quot;</span>;
LoggingMediator.AddLogger(logger);
LoggingMediator.Log(<span style="color:#a31515">&quot;Test&quot;</span>); 
</pre>
</div>
<p>By default however, the log is created on the local machine. If you want to explicitly create a log on the local machine without having to know the current machine name, set the name to &quot;.&quot;.</p>
<p>The event log logger logs the provided event as is, meaning that the provided text is simply written to the log without applying any changes. The Windows event log also assigns event types to each entry. These types are different from the CODE Framework
 event types, but they are similar. They are also automatically mapped:</p>
<table cellspacing="0" cellpadding="1" border="0">
<tbody>
<tr>
<td valign="top"><strong>CODE Framework Event Type</strong></td>
<td valign="top"><strong>Windows Event Type</strong></td>
</tr>
<tr>
<td valign="top">LogEventType.Critical</td>
<td valign="top">EventLogEntryType.Error</td>
</tr>
<tr>
<td valign="top">LogEventType.Error</td>
<td valign="top">EventLogEntryType.FailureAudit</td>
</tr>
<tr>
<td valign="top">LogEventType.Exception</td>
<td valign="top">EventLogEntryType.FailureAudit</td>
</tr>
<tr>
<td valign="top">LogEventType.Warning</td>
<td valign="top">EventLogEntryType.Warning</td>
</tr>
<tr>
<td valign="top">LogEventType.Success</td>
<td valign="top">EventLogEntryType.SuccessAudit</td>
</tr>
<tr>
<td valign="top">All other:</td>
<td valign="top">EventLogEntryType.Information</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3>Email Logger</h3>
<p>The email logger sends all events as emails via an SMTP server. It requires a file name and a path when instantiated:</p>
<p><code><font face="Consolas">var recipients = EmailLogger.GetRecipientsFromConfigFile();<br>
if (recipients.Count &gt; 0)<br>
{<br>
&nbsp;&nbsp;&nbsp; var emailLogger = new EmailLogger(&quot;My App&quot;, &quot;support@mycompany.com&quot;, recipients,
</font><font face="Consolas">&quot;My Comapany's App&quot;);<br>
&nbsp;&nbsp;&nbsp; LoggingMediator.AddLogger(emailLogger);<br>
}</font></code></p>
<div style="color:black">Sample .config settings:</div>
<div style="color:black"><code>&lt;add key=&quot;DefaultMailServer&quot; value=&quot;smtp.mycompany.com&quot;/&gt;</code><br>
<code>&lt;add key=&quot;EmailLoggerRecipients&quot; value=&quot;support@mycompany.com|Support Desk;fred@mycompany.com|Fred Flintstone&quot;/&gt;</code></div>
<div style="color:black">&nbsp;</div>
<div style="color:black">Emails are sent on a background thread using the ThreadPool.</div>
<div style="color:black">&nbsp;</div>
<h2>Creating Custom Loggers</h2>
<p>For many scenarios it is beneficial to add custom loggers. This can be done by derriving from the abstract
<em>Logger</em> class. For more control, it is also possible to implement the <em>
ILogger</em> interface.</p>
<h3>Deriving from Logger</h3>
<p>The abstract <em>Logger</em> class provides a good starting point for most needs. This class allows developers to quickly create custom loggers without having to implement the entire
<em>ILogger</em> interface. The following example shows a simple logger that logs to a message box:</p>
<div style="color:black">
<pre><span style="color:blue">public</span> <span style="color:blue">class</span> MyLogger : CODE.Framework.Core.Utilities.Logger
{
    <span style="color:blue">public</span> <span style="color:blue">override</span> <span style="color:blue">void</span> Log(<span style="color:blue">string</span> <span style="color:blue">event</span>, LogEventType type)
    {
        MessageBox.Show(<span style="color:#a31515">&quot;Event occured: &quot;</span> &#43; <span style="color:blue">event</span>);
    }
} 
</pre>
</div>
<p>This class can then be registered like all other event loggers:</p>
<div style="color:black">
<pre>LoggingMediator.AddLogger(<span style="color:blue">new</span> MyLogger()); 
</pre>
</div>
<p>What's nice about using the abstract <em>Logger</em> class is that it provides basical functionality such as the
<em>TypeFilter</em> property.</p>
<h3>Special Handling of Exception Logging</h3>
<p>The abstract Logger class implements the ILogger interface (see below) as well as the extended IExceptionLogger interface, which provides two special methods for logging exception information. This is an optional interface in the logging system, which provides
 greater control over how exception information is logged. (If a logger doesn’t implement this interface, then exception information will just be turned into text and logged as regular text).
</p>
<p>The abstract Logger class implements both methods supported by the IExceptionLogger interface. Both are implemented as virtual, so they can be overridden. Furthermore, the default implementation uses a GetSerialziedExceptionText() method, which turns a logged
 exception into its text representation, which is what is logged by default. This method is also virtual, and can thus be overridden in subclasses.</p>
<p>Common scenarios for changing exception logging behavior is to override the Log() methods and thus replacing the default behavior, which provides developers with full control over how exceptions are logged. If all that is needed on the other hand is a change
 in how the exception information is serialized as text (perhaps because the developer wishes to log different information), then one can simply override the GetSerializedExceptionText() method.</p>
<h3>Implementing the ILogger Interface</h3>
<p>For those developers who want more control, it is also possible to implement the
<em>ILogger</em> interface:</p>
<div style="color:black">
<pre><span style="color:blue">public</span> <span style="color:blue">class</span> MyLogger : ILogger
{<br><span style="color:blue">    public</span> MyLogger()<br>    {<br>        TypeFilter = LogEventType.Undefined;<br>    }<br>
    <span style="color:blue">public</span> <span style="color:blue">void</span> Log(<span style="color:blue">string</span> <span style="color:blue">event</span>, LogEventType type)
    {
        MessageBox.Show(<span style="color:#a31515">&quot;Event occured: &quot;</span> &#43; <span style="color:blue">event</span>);
    }<br>
    <span style="color:blue">public</span> <span style="color:blue">void</span> Log(<span style="color:blue">object</span> <span style="color:blue">event</span>, LogEventType type)
    {
        <span style="color:blue">this</span>.Log(<span style="color:blue">event</span>.ToString(), type);
    }<br> <br><br>    <span style="color:blue">public</span> LogEventType TypeFilter { get; set; }
} 
</pre>
</div>
<p><em>Note: This is very similar to the implementation of the </em>Logger <em>abstract class, except that the</em> Logger
<em>class defined all members as virtual so they can be overridden in subclasses.</em></p>
</div><div class="ClearBoth"></div>