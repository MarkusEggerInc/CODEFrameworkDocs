<div class="wikidoc">
<p><em>Excerpt from an internal email at CODE:</em></p>
<h2>Auto-Complete in WPF UIs</h2>
<p>FYI: Recetnly, Thom asked me to help him create an auto-complete UI for PCCA. He was looking for a control he could use for the purpose. After looking for some solutions, none of which was really appealing, we decided to add an auto-complete feature to CODE
 Framework&rsquo;s WPF controls.</p>
<p>We came up with a pretty cool solution. We created attached properties, which allows us to turn any control into a control that supports auto-complete. For instance, if you have a textbox that has a customer name and you want to show a list of matches to
 create a UI like this:</p>
<p><img src="http://download.codeplex.com/Download?ProjectName=codeframework&DownloadId=375694" alt=""></p>
<p>The idea here is that you have this bound textbox and can then say &ldquo;I want this to support auto-complete&rdquo; and to populate the auto-complete drop down list, you specify the items source for that (binding). When the user selects an item from the
 list, that item gets put into another property in the view model. The definition of the above textbox looks like this:</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">&lt;</span><span style="color:#a31515">TextBox</span> <span style="color:red">Text</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding CustomerName, UpdateSourceTrigger=PropertyChanged}</span><span style="color:black">&quot;</span> <br>         <span style="color:red">my:AutoComplete.AutoCompleteItemsSource</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding CustomersAutoComplete}</span><span style="color:black">&quot;</span> <br>         <span style="color:red">my:AutoComplete.AutoCompleteDisplayMemberPath</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">FullName</span><span style="color:black">&quot;</span> <br>         <span style="color:red">my:AutoComplete.AutoCompleteSelectedItem</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding <br>                     SelectedAutoCompleteCustomer, Mode=TwoWay}</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span> </pre>
</div>
<p>The associated properties in the view model look like this:</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">private</span> <span style="color:blue">string</span> _customerName;
<span style="color:blue">public</span> <span style="color:blue">string</span> CustomerName
{
    <span style="color:blue">get</span> { <span style="color:blue">return</span> _customerName; }
    <span style="color:blue">set</span>
    {
        _customerName = value;
        NotifyChanged(<span style="color:#a31515">&quot;CustomerName&quot;</span>);
        CustomersAutoComplete.Clear();
        <span style="color:blue">if</span> (!<span style="color:blue">string</span>.IsNullOrEmpty(value))
            <span style="color:blue">for</span> (<span style="color:blue">int</span> i = 0; i &lt; 10; i&#43;&#43;)
                CustomersAutoComplete.Add(<br>                    <span style="color:blue">new</span> CustomerQuickInformation <br>                        {<br>                            FirstName = <span style="color:#a31515">&quot;Thom&quot;</span>, <br>                            LastName = value &#43; <span style="color:#a31515">&quot; #&quot;</span> &#43; i<br>                        });
    }
}
 
<span style="color:blue">private</span> CustomerQuickInformation _selectedAutoCompleteCustomer;
<span style="color:blue">public</span> CustomerQuickInformation SelectedAutoCompleteCustomer
{
    <span style="color:blue">get</span> { <span style="color:blue">return</span> _selectedAutoCompleteCustomer; }
    <span style="color:blue">set</span>
    {
        _selectedAutoCompleteCustomer = value;
        CustomerName = value.FullName;
        NotifyChanged();
    }
}
 
<span style="color:blue">public</span> ObservableCollection&lt;CustomerQuickInformation&gt; <br>           CustomersAutoComplete { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }</pre>
</div>
<p>Of course the idea here would be that you would go to some sort of data source to populate the items in the CustomersAutoComplete collection, rather than hardcoding it like I did in my example. But you get the idea.</p>
<p>There are a few things that are really cool about this setup. For one, as mentioned above, this is not specific to a control, but you can attach this behavior to any control, simply by setting the auto-complete attached properties. Cool, hm? The other thing
 that is really cool is that the drop-down part of the auto-complete is basically a listbox that is completely stylable. For instance, I created another auto-complete UI that allows the user to enter folder and file names and the drop-down part shows the associated
 contents in a nice way:</p>
<p><img src="http://download.codeplex.com/Download?ProjectName=codeframework&DownloadId=375695" alt="">&nbsp;</p>
<p>In this case, the view model simply searches for the files entered and puts them into a collection the auto-complete drop-down is bound to. I also do a bit of extra work to show a folder icon or a file icon. Plus, I am showing the file date. This goes to
 show that you can have very rich content in the drop-down. You can basically do whatever you want.</p>
<p>Here&rsquo;s the code for the textbox:</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">&lt;</span><span style="color:#a31515">TextBox</span> <span style="color:red">Text</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding File, UpdateSourceTrigger=PropertyChanged}</span><span style="color:black">&quot;</span> 
         <span style="color:red">my:AutoComplete.AutoCompleteItemsSource</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FilesAutoComplete}</span><span style="color:black">&quot;</span>
         <span style="color:red">my:AutoComplete.AutoCompleteSelectedItem</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding SelectedAutoCompleteFile, Mode=TwoWay}</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">my</span><span style="color:blue">:</span><span style="color:#a31515">AutoComplete.AutoCompleteItemTemplate</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;</span><span style="color:#a31515">DataTemplate</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">Grid</span> <span style="color:red">my:GridEx.ColumnWidths</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Auto,Auto,Auto</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">Rectangle</span> <span style="color:red">Height</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">24</span><span style="color:black">&quot;</span> <span style="color:red">Width</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">24</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1</span><span style="color:black">&quot;</span> <span style="color:red">Fill</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{DynamicResource FolderIcon}</span><span style="color:black">&quot;</span> <span style="color:red">Visibility</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FolderVisible, Mode=OneWay}</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">Rectangle</span> <span style="color:red">Height</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">24</span><span style="color:black">&quot;</span> <span style="color:red">Width</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">24</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1</span><span style="color:black">&quot;</span> <span style="color:red">Fill</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{DynamicResource FileIcon}</span><span style="color:black">&quot;</span> <span style="color:red">Visibility</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FileVisible, Mode=OneWay}</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">TextBlock</span> <span style="color:red">Text</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FileName}</span><span style="color:black">&quot;</span> <span style="color:red">FontSize</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">14</span><span style="color:black">&quot;</span> <span style="color:red">FontFamily</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Adobe Gothic Std B</span><span style="color:black">&quot;</span> <span style="color:red">Grid.Column</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">3,0,0,0</span><span style="color:black">&quot;</span> <span style="color:red">VerticalAlignment</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Bottom</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">TextBlock</span> <span style="color:red">Text</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding Date}</span><span style="color:black">&quot;</span> <span style="color:red">FontSize</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">11</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">10,0,10,5</span><span style="color:black">&quot;</span> <span style="color:red">VerticalAlignment</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Bottom</span><span style="color:black">&quot;</span> <span style="color:red">Grid.Column</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2</span><span style="color:black">&quot;</span> <span style="color:red">Foreground</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Gray</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
            <span style="color:blue">&lt;/</span><span style="color:#a31515">Grid</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;/</span><span style="color:#a31515">DataTemplate</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">my</span><span style="color:blue">:</span><span style="color:#a31515">AutoComplete.AutoCompleteItemTemplate</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">TextBox</span><span style="color:blue">&gt;</span></pre>
</div>
<p>This is the kind of thing that looks like it should be really hard to do, but it really isn&rsquo;t. As long as you are familiar with styling items in a listbox, you are good to go. (And if not, make sure you read my
<a href="http://codemag.com/Article/112091">listbox styling article</a>!!!). In fact, if you are familiar with styling of listboxes, you can totally go to town on this. Consider this next example, where I also changed the layout of the listbox items and I also
 show a preview image if the file in the drop down is an image:</p>
<p><img src="http://download.codeplex.com/Download?ProjectName=codeframework&DownloadId=375696" alt=""></p>
<p>Pretty cool, hu?</p>
<p>The code here is a little more involved (and you can find all of this in the source of the CODE Framework under the test bench app and the AutoCompleteTest.xaml file):</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">&lt;</span><span style="color:#a31515">TextBox</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">25,0,25,370</span><span style="color:black">&quot;</span>
            <span style="color:red">Text</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding File, UpdateSourceTrigger=PropertyChanged}</span><span style="color:black">&quot;</span>
            <span style="color:red">my:AutoComplete.AutoCompleteItemsSource</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FilesAutoComplete}</span><span style="color:black">&quot;</span> 
            <span style="color:red">my:AutoComplete.AutoCompleteSelectedItem</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding SelectedAutoCompleteFile, Mode=TwoWay}</span><span style="color:black">&quot;</span> 
            <span style="color:red">Height</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">22</span><span style="color:black">&quot;</span> <span style="color:red">VerticalAlignment</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Bottom</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">my</span><span style="color:blue">:</span><span style="color:#a31515">AutoComplete.AutoCompleteItemTemplate</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;</span><span style="color:#a31515">DataTemplate</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">Grid</span> <span style="color:red">my:GridEx.RowHeights</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Auto,Auto,Auto</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">Rectangle</span> <span style="color:red">Height</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">64</span><span style="color:black">&quot;</span> <span style="color:red">Width</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">64</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1</span><span style="color:black">&quot;</span> <span style="color:red">Fill</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{DynamicResource FolderIcon}</span><span style="color:black">&quot;</span> <span style="color:red">Visibility</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FolderVisible, Mode=OneWay}</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">Rectangle</span> <span style="color:red">Height</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">64</span><span style="color:black">&quot;</span> <span style="color:red">Width</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">64</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1</span><span style="color:black">&quot;</span> <span style="color:red">Fill</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{DynamicResource FileIcon}</span><span style="color:black">&quot;</span> <span style="color:red">Visibility</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FileVisible, Mode=OneWay}</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">Rectangle</span> <span style="color:red">Height</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">64</span><span style="color:black">&quot;</span> <span style="color:red">HorizontalAlignment</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Stretch</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1</span><span style="color:black">&quot;</span> <span style="color:red">Fill</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding PreviewImage}</span><span style="color:black">&quot;</span> <span style="color:red">Visibility</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding PreviewVisible, Mode=OneWay}</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">TextBlock</span> <span style="color:red">Text</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding FileName}</span><span style="color:black">&quot;</span> <span style="color:red">FontSize</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">11</span><span style="color:black">&quot;</span> <span style="color:red">FontFamily</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Adobe Gothic Std B</span><span style="color:black">&quot;</span> <span style="color:red">Grid.Row</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2</span><span style="color:black">&quot;</span> <span style="color:red">HorizontalAlignment</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Center</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">TextBlock</span> <span style="color:red">Text</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{Binding Date}</span><span style="color:black">&quot;</span> <span style="color:red">FontSize</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">11</span><span style="color:black">&quot;</span> <span style="color:red">Margin</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2,2,2,8</span><span style="color:black">&quot;</span> <span style="color:red">Grid.Row</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">2</span><span style="color:black">&quot;</span> <span style="color:red">Foreground</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Gray</span><span style="color:black">&quot;</span> <span style="color:red">HorizontalAlignment</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Center</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
            <span style="color:blue">&lt;/</span><span style="color:#a31515">Grid</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;/</span><span style="color:#a31515">DataTemplate</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">my</span><span style="color:blue">:</span><span style="color:#a31515">AutoComplete.AutoCompleteItemTemplate</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">my</span><span style="color:blue">:</span><span style="color:#a31515">AutoComplete.AutoCompleteStyle</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;</span><span style="color:#a31515">Style</span> <span style="color:red">TargetType</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">my:AutoComplete</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">Style.Resources</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">SolidColorBrush</span> <span style="color:red">x:Key</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">{x:Static SystemColors.InactiveSelectionHighlightBrushKey}</span><span style="color:black">&quot;</span> <span style="color:red">Color</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Red</span><span style="color:black">&quot;</span> <span style="color:red">Opacity</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">.33</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
            <span style="color:blue">&lt;/</span><span style="color:#a31515">Style.Resources</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">Setter</span> <span style="color:red">Property</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Effect</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">Setter.Value</span><span style="color:blue">&gt;</span>
                    <span style="color:blue">&lt;</span><span style="color:#a31515">DropShadowEffect</span> <span style="color:red">Opacity</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">.5</span><span style="color:black">&quot;</span> <span style="color:red">BlurRadius</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">10</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                <span style="color:blue">&lt;/</span><span style="color:#a31515">Setter.Value</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;/</span><span style="color:#a31515">Setter</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">Setter</span> <span style="color:red">Property</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MaxHeight</span><span style="color:black">&quot;</span> <span style="color:red">Value</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">350</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">Setter</span> <span style="color:red">Property</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ScrollViewer.HorizontalScrollBarVisibility</span><span style="color:black">&quot;</span> <span style="color:red">Value</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Disabled</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">Setter</span> <span style="color:red">Property</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ItemsPanel</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">Setter.Value</span><span style="color:blue">&gt;</span>
                    <span style="color:blue">&lt;</span><span style="color:#a31515">ItemsPanelTemplate</span><span style="color:blue">&gt;</span>
                        <span style="color:blue">&lt;</span><span style="color:#a31515">WrapPanel</span> <span style="color:red">ScrollViewer.HorizontalScrollBarVisibility</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Disabled</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
                    <span style="color:blue">&lt;/</span><span style="color:#a31515">ItemsPanelTemplate</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;/</span><span style="color:#a31515">Setter.Value</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;/</span><span style="color:#a31515">Setter</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;/</span><span style="color:#a31515">Style</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">my</span><span style="color:blue">:</span><span style="color:#a31515">AutoComplete.AutoCompleteStyle</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">TextBox</span><span style="color:blue">&gt;</span></pre>
</div>
<p>This is a little longer, but really not very complex. You can simply set the style of the auto complete drop down, and once you get that, you can do whatever you want. In my case, the main thing is that I set the ItemsPanelTemplate to a WrapPanel, which
 creates the flowing layout of items.</p>
</div><div class="ClearBoth"></div>